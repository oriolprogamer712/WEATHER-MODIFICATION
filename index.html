<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Previsión del Clima - 14 Días</title>
    <style>
        /* CSS3 para estilizar la página */

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #83a4d4, #b6fbff);
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #4a90e2;
            color: white;
            padding: 20px;
            text-align: center;
        }

        #forecast {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 20px;
        }

        .day {
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            margin: 10px;
            padding: 15px;
            width: 150px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            text-align: center;
        }

        .day img {
            width: 50px;
            height: 50px;
        }

        footer {
            background-color: #4a90e2;
            color: white;
            padding: 10px;
            text-align: center;
        }

        @media (max-width: 600px) {
            .day {
                width: 100px;
                padding: 10px;
            }

            .day img {
                width: 40px;
                height: 40px;
            }
        }
    </style>
</head>
<body>

    <header>
        <h1>Previsión del Clima - 14 Días</h1>
        <p>Actualizado cada 5 minutos - Versión 1.0</p>
    </header>

    <div id="forecast">
        <!-- Previsión del clima se cargará aquí -->
    </div>

    <footer>
        <p>Próximas actualizaciones: Mejora de la interfaz, Integración con redes sociales.</p>
        <p>En desarrollo: Pronto Habrau Un Modificador del clima real solo para España para evitar sequías extremas o muy extremas (Disponible en Q1 2030).</p>
    </footer>

    <script>
        // JavaScript para obtener y mostrar la previsión del clima

        const apiKey = 'b75a6ee071df6af45e2820e6b07ffdfb'; // Reemplaza con tu API key de OpenWeatherMap
        const city = 'Madrid,ES'; // Ciudad para la que deseas la previsión
        const units = 'metric'; // Unidades métricas
        const forecastContainer = document.getElementById('forecast');

        // Función para obtener la latitud y longitud de la ciudad
        async function getCoordinates(city) {
            const geoUrl = `https://api.openweathermap.org/geo/1.0/direct?q=${city}&limit=1&appid=${apiKey}`;
            const response = await fetch(geoUrl);
            const data = await response.json();
            if (data.length === 0) {
                alert('Ciudad no encontrada.');
                return null;
            }
            return { lat: data[0].lat, lon: data[0].lon };
        }

        // Función para obtener la previsión del clima
        async function getWeather(lat, lon) {
            const weatherUrl = `https://api.openweathermap.org/data/2.5/onecall?lat=${lat}&lon=${lon}&exclude=current,minutely,hourly,alerts&units=${units}&appid=${apiKey}`;
            const response = await fetch(weatherUrl);
            const data = await response.json();
            return data.daily.slice(0, 14); // Obtener los primeros 14 días
        }

        // Función para mostrar la previsión en el DOM
        function displayForecast(forecast) {
            forecastContainer.innerHTML = ''; // Limpiar contenido previo
            forecast.forEach(day => {
                const date = new Date(day.dt * 1000);
                const dayName = date.toLocaleDateString('es-ES', { weekday: 'long', month: 'short', day: 'numeric' });
                const tempMax = Math.round(day.temp.max);
                const tempMin = Math.round(day.temp.min);
                const weatherIcon = `https://openweathermap.org/img/wn/${day.weather[0].icon}@2x.png`;
                const description = day.weather[0].description;

                const dayDiv = document.createElement('div');
                dayDiv.className = 'day';
                dayDiv.innerHTML = `
                    <h3>${dayName}</h3>
                    <img src="${weatherIcon}" alt="${description}">
                    <p>${description.charAt(0).toUpperCase() + description.slice(1)}</p>
                    <p>Máx: ${tempMax}°C</p>
                    <p>Mín: ${tempMin}°C</p>
                `;
                forecastContainer.appendChild(dayDiv);
            });
        }

        // Función principal para obtener y mostrar el clima
        async function updateWeather() {
            const coords = await getCoordinates(city);
            if (coords) {
                const forecast = await getWeather(coords.lat, coords.lon);
                displayForecast(forecast);
            }
        }

        // Actualizar el clima al cargar la página
        updateWeather();

        // Actualizar el clima cada 5 minutos (290000 ms)
        setInterval(updateWeather, 290000);
    </script>

</body>
</html>
